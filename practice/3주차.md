# ëª¨ë‹¬ ì„±ëŠ¥ ìµœì í™” í•´ë³´ê¸°

1. Local state vs Redux state
2. Lazy loading ì ìš©

Ref. [useOverlay](https://slash.page/ko/libraries/react/use-overlay/src/useOverlay.i18n)

<img src="assets/3ì£¼ì°¨/modal.png" width="50%" height="20%" title="modal" alt="before-perf1" />

## Local state vs Redux state

visible ON/OFF í† ê¸€í•  ë•Œ page ë‹¨ì—ì„œ local ìƒíƒœë¥¼ ì•ˆ ì“¸ ìˆ˜ ìˆëŠ” ë°©ë²• ê³ ë ¤

### Local state

```javascript
const IndexPage: NextPageWithLayout = ({}: {}) => {
  const [show, setShow] = useBoolean(false);

  console.log('Index Page Render!');

  return (
    <>
      <Button onClick={setShow.on}>í”„ë¡œíŒŒì¼ ëª¨ë‹¬</Button>
      {show && <TestProfileModal />}
    </>
  );
};

export default IndexPage;
```

ë²„íŠ¼ í´ë¦­ í›„ ğŸ”½  
![ë²„íŠ¼ í´ë¦­ í›„](assets/3ì£¼ì°¨/localLog1.png)

window refocus ğŸ”½ (Modalì˜ ì½˜ì†”ë„ ê³„ì† ì°í˜)  
![window refocus](assets/3ì£¼ì°¨/localLog2.png)

## Redux state

```javascript
const IndexPage: NextPageWithLayout = ({}: {}) => {
  const showProfileModal = useAppSelector(
    (state) => state.ui.showProfileModal,
    shallowEqual
  );
  const getProfileQuery = useGetProfile();

  console.log('Index Page Render!');

  return <>{showProfileModal && <ProfileModal />}</>;
};

export default IndexPage;
```

ë²„íŠ¼ í´ë¦­ í›„ ğŸ”½  
![ë²„íŠ¼ í´ë¦­ í›„](assets/3ì£¼ì°¨/reduxLog1.png)

window refocus ğŸ”½ (Modalì˜ ì½˜ì†”ì€ ì•ˆ ì°í˜)  
![window refocus](assets/3ì£¼ì°¨/reduxLog2.png)

## Lazy loading ì ìš©

### Before

```javascript
const IndexPage: NextPageWithLayout = ({}: {}) => {
  const showProfileModal = useAppSelector(
    (state) => state.ui.showProfileModal,
    shallowEqual
  );
  const getProfileQuery = useGetProfile();

  console.log('Index Page Render!');

  return <>{showProfileModal && <ProfileModal />}</>;
};

export default IndexPage;
```

![before](assets/3ì£¼ì°¨/before.png)

### Before

```javascript
const LazyProfileModal = lazy(() =>
  import('../components/profile/profileModal')
);

const IndexPage: NextPageWithLayout = ({}: {}) => {
  const showProfileModal = useAppSelector(
    (state) => state.ui.showProfileModal,
    shallowEqual
  );
  const getProfileQuery = useGetProfile();

  console.log('Index Page Render!');

  return (
    <>
      <Suspense fallback={<></>}>
        {showProfileModal && <LazyProfileModal />}
      </Suspense>
    </>
  );
};

export default IndexPage;
```

![before](assets/3ì£¼ì°¨/after.png)
